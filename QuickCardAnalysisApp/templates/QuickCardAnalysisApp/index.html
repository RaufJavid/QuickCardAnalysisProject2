{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Quick Card Analysis App</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">

    <!-- Bootstrap core CSS -->
    <link href="https://mdbootstrap.com/previews/docs/latest/css/bootstrap.min.css" rel="stylesheet">

    <!-- Material Design Bootstrap -->
    <link href="https://mdbootstrap.com/previews/docs/latest/css/mdb.min.css" rel="stylesheet">


    <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.noStyle.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-grid.css">
    <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-theme-balham.css">
    {#    <script src="https://www.papaparse.com/resources/js/jquery.min.js"></script>#}


    <link rel="stylesheet" type="text/css" href="https://dc-js.github.io/dc.js/css/dc.css"/>
    <script type="text/javascript" src="https://dc-js.github.io/dc.js/js/promise-polyfill.js"></script>
    <script type="text/javascript" src="https://dc-js.github.io/dc.js/js/fetch.umd.js"></script>
    <script type="text/javascript" src="https://dc-js.github.io/dc.js/js/d3.js"></script>
    <script type="text/javascript" src="https://dc-js.github.io/dc.js/js/crossfilter.js"></script>
    <script type="text/javascript" src="https://dc-js.github.io/dc.js/js/dc.js"></script>


    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

</head>

<body class="fixed-sn black-skin">

<!--Double navigation-->
<header>
    <!-- Sidebar navigation -->
    <div id="slide-out" class="side-nav sn-bg-4 fixed mdb-sidenav">
        <ul class="custom-scrollbar list-unstyled" style="max-height:100vh;">
            <!-- Logo -->
            <li>
                <div class="logo-wrapper waves-light">
                    <a href="#"><img src="https://mdbootstrap.com/img/logo/mdb-transparent.png"
                                     class="img-fluid flex-center"></a>
                </div>
            </li>
            <!--/. Logo -->
            <!--Social-->
            <li>
                <ul class="social">
                    <li><a href="#" class="icons-sm fb-ic"><i class="fab fa-facebook-f"> </i></a></li>
                    <li><a href="#" class="icons-sm pin-ic"><i class="fab fa-pinterest"> </i></a></li>
                    <li><a href="#" class="icons-sm gplus-ic"><i class="fab fa-google-plus-g"> </i></a></li>
                    <li><a href="#" class="icons-sm tw-ic"><i class="fab fa-twitter"> </i></a></li>
                </ul>
            </li>
            <!--/Social-->
            <!--Search Form-->
            <li>
                <form class="search-form" role="search">
                    <div class="form-group md-form mt-0 pt-1 waves-light">
                        <input type="text" class="form-control" placeholder="Search">
                    </div>
                </form>
            </li>
            <!--/.Search Form-->
            <!-- Side navigation links -->
            <li>
                <ul class="collapsible collapsible-accordion">
                    <li><a class="collapsible-header waves-effect arrow-r"><i class="fas fa-chevron-right"></i> Submit
                        blog<i class="fas fa-angle-down rotate-icon"></i></a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a href="#" class="waves-effect">Submit listing</a>
                                </li>
                                <li><a href="#" class="waves-effect">Registration form</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li><a class="collapsible-header waves-effect arrow-r"><i class="far fa-hand-pointer"></i>
                        Instruction<i class="fas fa-angle-down rotate-icon"></i></a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a href="#" class="waves-effect">For bloggers</a>
                                </li>
                                <li><a href="#" class="waves-effect">For authors</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li><a class="collapsible-header waves-effect arrow-r"><i class="fas fa-eye"></i> About<i
                            class="fas fa-angle-down rotate-icon"></i></a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a href="#" class="waves-effect">Introduction</a>
                                </li>
                                <li><a href="#" class="waves-effect">Monthly meetings</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li><a class="collapsible-header waves-effect arrow-r"><i class="far fa-envelope"></i> Contact me<i
                            class="fas fa-angle-down rotate-icon"></i></a>
                        <div class="collapsible-body">
                            <ul>
                                <li><a href="#" class="waves-effect">FAQ</a>
                                </li>
                                <li><a href="#" class="waves-effect">Write a message</a>
                                </li>
                                <li><a href="#" class="waves-effect">FAQ</a>
                                </li>
                                <li><a href="#" class="waves-effect">Write a message</a>
                                </li>
                                <li><a href="#" class="waves-effect">FAQ</a>
                                </li>
                                <li><a href="#" class="waves-effect">Write a message</a>
                                </li>
                                <li><a href="#" class="waves-effect">FAQ</a>
                                </li>
                                <li><a href="#" class="waves-effect">Write a message</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </li>
            <!--/. Side navigation links -->
        </ul>
        <div class="sidenav-bg mask-strong"></div>
    </div>
    <!--/. Sidebar navigation -->
    <!-- Navbar -->
    <nav class="navbar navbar-toggleable-md navbar-expand-lg scrolling-navbar double-nav deep-purple darken-2">
        <!-- SideNav slide-out button -->
        <div class="float-left">
            <a href="#" data-activates="slide-out" class="button-collapse"><i class="fas fa-bars"></i></a>
        </div>
        <!-- Breadcrumb-->
        <div class="breadcrumb-dn mr-auto">
            <p>Quick Card Analysis App</p>
        </div>
        <ul class="nav navbar-nav nav-flex-icons ml-auto">
            <li class="nav-item">
                <a class="nav-link"><i class="fas fa-envelope"></i> <span class="clearfix d-none d-sm-inline-block">Contact</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link"><i class="far fa-comments"></i> <span class="clearfix d-none d-sm-inline-block">Support</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link"><i class="fas fa-user"></i> <span
                        class="clearfix d-none d-sm-inline-block">Account</span></a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    Dropdown
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                    <a class="dropdown-item" href="#">Action</a>
                    <a class="dropdown-item" href="#">Another action</a>
                    <a class="dropdown-item" href="#">Something else here</a>
                </div>
            </li>
        </ul>
    </nav>
    <!-- /.Navbar -->
</header>
<!--/.Double navigation-->

<!--Main Layout-->
<main>

    <h2>Welcome To Quick Card Analysis App</h2>

    <div class="container-fluid">


        <div class="row">

            <div class="col-4">

                <!-- Card -->
                <div class="card card-cascade overlay">

                    <!-- Card image -->
                    <div class="view view-cascade gradient-card-header blue-gradient">

                        <!-- Title -->
                        <h5 class="card-header-subtitle">Please Upload CSV File!</h5>


                    </div>


                </div>
                <!-- Card -->

            </div>

            <div class="col-4">

                {#<div class="file-upload-wrapper">#}
                {#   <input type="file" id="input-file-now-custom-2" class="file-upload"#}
                {#  data-height="500" />#}
                {#</div>#}
                {#                         <button type="button" class="btn btn-success btn-rounded">Upload</button>#}

                <script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>
                <script src="https://www.papaparse.com/resources/js/jquery.min.js"></script>
                <script>
                    var data;

                    function handleFileSelect(evt) {
                        var file = evt.target.files[0];

                        Papa.parse(file, {
                            header: true,
                            dynamicTyping: true,
                            complete: function (results) {
                                {#data = results;#}
                                console.log(results);
                            }
                        });
                    }

                    $(document).ready(function () {
                        $("#csv-file2").change(handleFileSelect);
                    });


                </script>


                {#D3 CSV File Loading Code#}


                <form class="md-form">
                    <div class="file-field big">
                        <a class="btn-floating btn-lg pink lighten-1 mt-0 float-left">
                            <i class="fas fa-paperclip" aria-hidden="true"></i>
                            <input type="file" id="csv-file" name="files"/>

                        </a>
                        <div class="file-path-wrapper">
                            <input class="file-path validate" type="text" placeholder="Upload your file">
                        </div>
                    </div>
                </form>

            </div>


            <div class="col-4">

            </div>


        </div>
        <hr>


        {#        Graph Cards Start#}

        <div class="row">
            <div class="col-6">
                <!-- Card -->
                <div class="card">
                    <div class='span12 chart-wrapper' id="dc-dayweek-chart">
                        <div class="chart-wrapper">
                            <div class="chart-title"
                                 style="font-size: x-large; background-color: orangered; color: white ">
                                <h4>Days Of The Week </h4>
                            </div>
                        </div>
                        <span class="reset" style="display: none;">
                                    Selected:
                                    <span class="filter">

                                    </span>
                                </span>
                        <br>
                        <a class="reset btn btn-primary btn-lg active"
                           href="javascript:day_Of_Week_Chart.filterAll();dc.redrawAll();" role="button"
                           style="display: none; float: right;">Reset</a>

                        <div class="clearfix"></div>

                    </div>


                </div>

                <!-- Card -->
            </div>
            <div class="col-6">
                <!-- Card -->
                <div class="card">


                    <div class='span12 chart-wrapper' id="name">

                        <div class="chart-wrapper">
                            <div class="chart-title"
                                 style="font-size: x-large; background-color: teal; color: white ">
                                <h4> Type Comparison </h4>
                                <div>
                                    <Select id="listOption4">
                                        <option disabled>Choose one</option>
                                        <Option selected value="5">5</Option>
                                        <Option value="10">10</Option>
                                        <Option value="15">15</Option>
                                        <Option value="20">20</Option>
                                        <Option value="25">25</Option>
                                        <Option value="Infinity">All</Option>
                                    </Select>
                                </div>
                            </div>
                        </div>

                        <span class="reset" style="display: none;">
                                    Selected:
                                    <span class="filter">

                                    </span>
                                </span>

                        <br>

                        <a class="reset btn btn-primary btn-lg active"
                           href="javascript:nameChart.filterAll();dc.redrawAll();" role="button"
                           style="display: none; float: right;">Reset</a>

                        <div class="clearfix"></div>

                    </div>


                </div>
                <!-- Card -->
            </div>


        </div>
        {#        Graph Cards End#}
        <hr>

        {#CSV Table Display data#}
        <div class="row">

            <div id="myGrid" style="height: 600px;width:100%;" class="ag-theme-balham"></div>

            <script src="https://d3js.org/d3-dsv.v1.min.js"></script>
            <script src="https://d3js.org/d3-fetch.v1.min.js"></script>


            <script type="text/javascript" charset="utf-8">
                var day_Of_Week_Chart;
                var nameChart;
                var listItem4;

                function handleFileSelect(evt) {


                    var file = evt.target.files[0];
                    if (file) {
                        var reader = new FileReader();
                        reader.onloadend = function (evt) {
                            var dataUrl = evt.target.result;


                            var facts;
                            day_Of_Week_Chart = dc.rowChart("#dc-dayweek-chart");
                            nameChart = dc.pieChart("#name");
                            listItem4 = $('#listOption4').find(":selected").text();


                            d3.csv(dataUrl).then(function (data) {
                                var rowData = data;

                                // specify the columns
                                var columnDefs = [
                                    {headerName: "block_id", field: "block_id"},
                                    {headerName: "date_time", field: "date_time"},
                                    {headerName: "main_type", field: "main_type"},
                                    {headerName: "sub_type", field: "sub_type"},
                                    {headerName: "action", field: "action"},
                                    {headerName: "gateway", field: "gateway"}
                                ];


                                // let the grid know which columns and what data to use
                                var gridOptions = {
                                    columnDefs: columnDefs,
                                    rowData: rowData
                                };



                                // lookup the container we want the Grid to use
                                var eGridDiv = document.querySelector('#myGrid');

                                // create the grid passing in the div to use together with the columns & data we want to use
                                new agGrid.Grid(eGridDiv, gridOptions);
                                console.log(data);


                                {#var dateFormat = d3.time.format('%Y-%m-%d');#}
                                data.forEach(function (d) {
                                    {#alert(d.date_time);#}
                                    d.date_time = new Date(d.date_time);


                                });
                                facts = crossfilter(data);

                                var nameDim = facts.dimension(function (d) {
                                    return d.main_type;
                                });

                                var nameGroup = nameDim.group().reduceCount();


                                // row chart Day of Week
                                var dayOfWeek = facts.dimension(function (d) {
                                    var day = d.date_time.getDay();
                                    switch (day) {
                                        case 0:
                                            return "0.Sun";
                                        case 1:
                                            return "1.Mon";
                                        case 2:
                                            return "2.Tue";
                                        case 3:
                                            return "3.Wed";
                                        case 4:
                                            return "4.Thu";
                                        case 5:
                                            return "5.Fri";
                                        case 6:
                                            return "6.Sat";
                                    }
                                });
                                var dayOfWeekGroup = dayOfWeek.group();


                                day_Of_Week_Chart
                                    .height(355)
                                    .margins({top: 5, left: 10, right: 10, bottom: 20})
                                    .dimension(dayOfWeek)
                                    .group(dayOfWeekGroup)
                                    .colors(d3.scaleOrdinal(d3.schemeCategory10))
                                    .label(function (d) {
                                        return d.key.split(".")[1];
                                    })
                                    .title(function (d) {
                                        return d.value;
                                    })
                                    .elasticX(true)
                                    .xAxis().ticks(4);

                                nameChart
                                    .height(355)
                                    .radius(200)
                                    .innerRadius(15)
                                    .externalLabels(30)
                                    .dimension(nameDim)
                                    .group(nameGroup)
                                    .legend(dc.legend())
                                    .data(function (group) {
                                        return group.top(listItem4);
                                    });


                                //Jquery DT

                                window.filter = function (filters) {
                                    filters.forEach(function (d, i) {
                                        charts[i].filter(d);
                                    });
                                    renderAll();
                                };

                                window.reset = function (i) {
                                    charts[i].filter(null);
                                    renderAll();
                                };


                                dc.renderAll();

                            });
                        };
                        reader.readAsDataURL(file);
                    }


                }

                $(document).ready(function () {
                    $("#csv-file").change(handleFileSelect);
                });

            </script>


        </div>


        <script src="https://mdbootstrap.com/wp-content/themes/mdbootstrap4/js/plugins/mdb-file-upload.min.js"></script>
        <script>$('.file_upload').file_upload();</script>

        <div style="height: 2000px"></div>
    </div>
</main>
<!--Main Layout-->


<!-- Footer -->
<footer class="page-footer font-small deep-purple darken-2">

    <div style="background-color: black;">
        <div class="container">

            <!-- Grid row-->
            <div class="row py-4 d-flex align-items-center">

                <!-- Grid column -->
                <div class="col-md-6 col-lg-5 text-center text-md-left mb-4 mb-md-0">
                    <h6 class="mb-0">Get connected with us on social networks!</h6>
                </div>
                <!-- Grid column -->

                <!-- Grid column -->
                <div class="col-md-6 col-lg-7 text-center text-md-right">

                    <!-- Facebook -->
                    <a class="fb-ic">
                        <i class="fab fa-facebook-f white-text mr-4"> </i>
                    </a>
                    <!-- Twitter -->
                    <a class="tw-ic">
                        <i class="fab fa-twitter white-text mr-4"> </i>
                    </a>
                    <!-- Google +-->
                    <a class="gplus-ic">
                        <i class="fab fa-google-plus-g white-text mr-4"> </i>
                    </a>
                    <!--Linkedin -->
                    <a class="li-ic">
                        <i class="fab fa-linkedin-in white-text mr-4"> </i>
                    </a>
                    <!--Instagram-->
                    <a class="ins-ic">
                        <i class="fab fa-instagram white-text"> </i>
                    </a>

                </div>
                <!-- Grid column -->

            </div>
            <!-- Grid row-->

        </div>
    </div>

    <!-- Footer Links -->
    <div class="container text-center text-md-left mt-5">

        <!-- Grid row -->
        <div class="row mt-3">

            <!-- Grid column -->
            <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">

                <!-- Content -->
                <h6 class="text-uppercase font-weight-bold">Company name</h6>
                <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
                <p>Here you can use rows and columns to organize your footer content. Lorem ipsum dolor sit amet,
                    consectetur
                    adipisicing elit.</p>

            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">

                <!-- Links -->
                <h6 class="text-uppercase font-weight-bold">Products</h6>
                <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
                <p>
                    <a href="#!">MDBootstrap</a>
                </p>
                <p>
                    <a href="#!">MDWordPress</a>
                </p>
                <p>
                    <a href="#!">BrandFlow</a>
                </p>
                <p>
                    <a href="#!">Bootstrap Angular</a>
                </p>

            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">

                <!-- Links -->
                <h6 class="text-uppercase font-weight-bold">Useful links</h6>
                <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
                <p>
                    <a href="#!">Your Account</a>
                </p>
                <p>
                    <a href="#!">Become an Affiliate</a>
                </p>
                <p>
                    <a href="#!">Shipping Rates</a>
                </p>
                <p>
                    <a href="#!">Help</a>
                </p>

            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">

                <!-- Links -->
                <h6 class="text-uppercase font-weight-bold">Contact</h6>
                <hr class="deep-purple accent-2 mb-4 mt-0 d-inline-block mx-auto" style="width: 60px;">
                <p>
                    <i class="fas fa-home mr-3"></i> New York, NY 10012, US</p>
                <p>
                    <i class="fas fa-envelope mr-3"></i> info@example.com</p>
                <p>
                    <i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>
                <p>
                    <i class="fas fa-print mr-3"></i> + 01 234 567 89</p>

            </div>
            <!-- Grid column -->

        </div>
        <!-- Grid row -->

    </div>
    <!-- Footer Links -->

    <!-- Copyright -->
    <div class="footer-copyright text-center py-3">© 2019 Copyright:
        <a href="https://mdbootstrap.com/education/bootstrap/"> quickcard.me </a>
    </div>
    <!-- Copyright -->

</footer>
<!-- Footer -->


<!-- SCRIPTS -->

<!-- JQuery -->
<script type="text/javascript" src="https://mdbootstrap.com/previews/docs/latest/js/jquery-3.3.1.min.js"></script>

<!-- Tooltips -->
<script type="text/javascript" src="https://mdbootstrap.com/previews/docs/latest/js/popper.min.js"></script>

<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://mdbootstrap.com/previews/docs/latest/js/bootstrap.min.js"></script>

<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://mdbootstrap.com/previews/docs/latest/js/mdb.min.js"></script>
<script>

    // SideNav Initialization
    $(".button-collapse").sideNav();

</script>
</body>
</html>